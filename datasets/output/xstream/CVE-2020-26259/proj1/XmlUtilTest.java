import org.junit.Test;
import static org.junit.Assert.assertTrue;

public class XmlUtilTest {

    @Test
    public void testVulnerabilityTriggered() {
        // Test input data
        String input = "poc.xml";

        // Wrap the vulnerable code in a try-catch block
        try {
            MethodCallInterceptor.interceptor(
                    com.thoughtworks.xstream.XStream.class, "fromXML", new Object[]{input}
            );

            // Call the function under test
            XmlUtil.xml2Obj(input, SomeClass.class);

        } catch (Exception e) {
            // Do nothing after catching the exception
        }

        // Assert that the vulnerability was successfully triggered
        assertTrue(MethodCallInterceptor.isTrigger);
    }

    // Define a sample class (SomeClass) for the xml2Obj method
    private static class SomeClass {
        // Define fields and methods as needed for testing
    }
}
