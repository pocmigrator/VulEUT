import org.junit.Test;
import static org.junit.Assert.assertTrue;
import java.io.File;
import java.io.IOException;

public class OfficeOpenXMLMatcherTest {

    @Test
    public void testVulnerabilityTriggered() {
        // Test input data (file path)
        String input = "dataset/poc/file/cve-2022-24615/proj1/crash-a49f954b47e05cc5265db441a64e5d2d55cb33b8";

        // Create a Java File from the input path
        File fileInput = new File(input);

        // Intercept the vulnerable method call
        MethodCallInterceptor.interceptor(
            net.lingala.zip4j.io.inputstream.ZipInputStream.class,
            "ZipInputStream",
            new Object[]{fileInput}
        );

        try {
            // Create an instance of OfficeOpenXMLMatcher and call the function under test
            OfficeOpenXMLMatcher officeOpenXMLMatcher = new OfficeOpenXMLMatcher();
            officeOpenXMLMatcher.matches(new Context(null, null, null, null, null)); // Provide appropriate context parameters
        } catch (IOException e) {
            // Exception caught, do nothing
        }

        // Assert that the vulnerability was successfully triggered
        assertTrue(MethodCallInterceptor.isTriggered());
        assertTrue(MethodCallInterceptor.isConditionMet());
    }
}
