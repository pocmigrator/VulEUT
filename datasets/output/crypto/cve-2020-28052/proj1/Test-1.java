import static org.junit.Assert.assertTrue;

import org.junit.Test;

public class BcryptPasswordHashFunctionTest {

    @Test
    public void testVulnerabilityTriggered() {
        // Input data
        String input = "$2a$10$603j/YReRMYwmT7T9mUI5uioFPV3Hv/NAom0eoBNtWeX6mVLrrGHe";

        // Intercepting method call to checkPassword
        MethodCallInterceptor.interceptor(
                org.bouncycastle.crypto.generators.OpenBSDBCrypt.class, "checkPassword", new Object[]{input}
        );

        try {
            // Call the function under test
            boolean result = new BcryptPasswordHashFunction().check("$2a$10$603j/YReRMYwmT7T9mUI5uioFPV3Hv/NAom0eoBNtWeX6mVLrrGHe", "012345");

        } catch (Exception e) {
            // Catch any exception
        }

        // Assert that vulnerability was triggered
        assertTrue(MethodCallInterceptor.isTriggered());
        assertTrue(MethodCallInterceptor.isConditionMet());
    }
}
