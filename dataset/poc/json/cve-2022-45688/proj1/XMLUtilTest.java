import static org.junit.Assert.assertTrue;
import org.junit.Test;
import org.json.JSONObject;
import org.json.XML;

public class XMLUtilTest {

    @Test
    public void testVulnerabilityTriggered() {
        try {
            // Input data
            String input = "<a>";
            
            // Intercept the method call
            MethodCallInterceptor.interceptor(
                org.json.XML.class,
                "toJSONObject",
                new Object[]{input}
            );

            // Call the vulnerable function
            XMLUtil.xml2json(input);

            // Assert that the vulnerability was successfully triggered
            assertTrue(MethodCallInterceptor.isTrigger);
        } catch (Exception e) {
            // Handle any exceptions here, or do nothing if none are expected
        }
    }
}
